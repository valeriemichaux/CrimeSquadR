---
title: "Datenauswertung"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(psych)
library(ggplot2)
library(fun)
library(colorspace)
library(Hmisc)

```

```{r}
datacleaning <- readr::read_csv("data/datacleaning.csv")

utilities<- readr::read_csv("data/Utilities.csv")

impo<- readr::read_csv2("data/Importances.csv")


importances.geschlecht<- readr::read_csv2("data/Importances_geschlecht.csv")

bind_cols(datacleaning, utilities, impo)-> new

new.short<-new[,c(-1, -9:-10, -22)]

#colnames(new.short)

names(new.short)[8:18]<- c("Konzert","Bahnhof","Einkaufsstraße","Bewegungsverlauf","Gesichtserkennung","Verdächtige Gegenstände", "KI liefert Erklärung", "KI liefert keine Erklärung", "Sofortige Löschung","Löschung nach 3 Monaten", "Dauerhafte Speicherung")

#Deskriptive Statistik 
mean(new.short$age)
min(new.short$age)
max(new.short$age)
sd(new.short$age)


#new.short%>% 
  #mutate(gender = case_when(
    #gender == "maennlich" ~ 1,
    #gender == "weiblich" ~ 2)) ->new.short

#table(new.short$gender)
#wir haben 41 Männer und 55 Frauen 

  
#T-Test: Welcher Geschlechtsunterschiede und Trade-Offs gibt es bei der Akzeptanzbewertung von KI-basierter Videoüberwachung?

#UV: Geschelcht; Gruppen: Männlich& weiblich, AV: Speicherung


#Code Bsp. t-Test

t.test(filter (new.short, gender == "maennlich")$Speicherung, filter(new.short, gender == "weiblich")$Speicherung)

#Es gibt keinen signifikanten Unterschied zwischen Männern und Frauen hinsichtlich der Akzeptanz von Datenspeicherung bei KI-basierter Videoüberwachung (t(78.67)= -0.34897, p=.728). 

t.test(filter (new.short, gender == "maennlich")$Speicherung, filter(new.short, gender == "weiblich")$Datenpartikel)
#Es gibt einen signifikanten Unterschied zwischen Männern und Frauen hinsichtlich ihrer Akzeptanz der Art der gesammelten Daten bei KI-basierter Videoüberwachung (t(63.93)= 6.2431, p<.0001).

t.test(filter (new.short, gender == "maennlich")$Speicherung, filter(new.short, gender == "weiblich")$Ort)
#Es gibt einen signifikanten Unterschied zwischen Männern und Frauen hinsichtlich ihrer Akzeptanz des Ortes bei KI-basierter Videoüberwachung (t(57.94)= 9.0427, p<.0001).

t.test(filter (new.short, gender == "maennlich")$Speicherung, filter(new.short, gender == "weiblich")$Erklärbarkeit)
#Es gibt einen signifikanten Unterschied zwischen Männern und Frauen hinsichtlich der Akzeptanz von Erklärbarkeit bei KI-basierter Videoüberwachung (t(65.25)= 9.2022, p<.0001).


mean(new.short$Ort)

```

```{r}
#Importances (nach Geschelchtern) visualisieren 

```




```{r}
#partworth utilities visualisieren 

pwu<- new.short%>% select("Konzert", "Bahnhof","Einkaufsstraße","Bewegungsverlauf","Gesichtserkennung","Verdächtige Gegenstände", "KI liefert Erklärung", "KI liefert keine Erklärung", "Sofortige Löschung", "Löschung nach 3 Monaten", "Dauerhafte Speicherung")%>%  pivot_longer(cols = everything(), names_to="pwu", values_to="score")


# Dieser Datensatz hat nun 1056 Zeilen wegen 11 (pwus)x 96 Probanden 
colnames(new.short)

pwu$pwu <- factor(
  pwu$pwu,
  levels = c
  (
    "Konzert",
    "Bahnhof",
    "Einkaufsstraße",
    "Bewegungsverlauf",
    "Gesichtserkennung",
    "Verdächtige Gegenstände",
    "KI liefert Erklärung",
    "KI liefert keine Erklärung",
    "Sofortige Löschung",
    "Löschung nach 3 Monaten",
    "Dauerhafte Speicherung"
  )
)


pwu%>%
  ggplot+
  aes(x=pwu, y=score)+
   stat_summary(geom = "bar", position = position_dodge(), color="#B0BAC3", fill="#B0BAC3") +
  stat_summary(fun.y = mean, geom = "point", size=0.8)+
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width=0.5, size=0.4, alpha=0.5) +
 #stat_summary(geom="text", aes(label=sprintf("%1.2f%%", ..y..)), size=3, position) +
  coord_flip()+
  #ylim(-100,100) +
   scale_y_continuous(limits = c(-100, 100), breaks = c(-100,-50,0,50,100)) +
  labs(x="Level", y="Teilnutzenwerte")+
  scale_x_discrete(label=c("Konzert","Bahnhof","Einkaufsstraße","Bewegungsverlauf","Gesichtserkennung","Verdächtige Gegenstände", "KI liefert Erklärung", "KI liefert keine Erklärung", "Sofortige Löschung", "Löschung nach 3 Monaten", "Dauerhafte Speicherung"))+
theme_classic()

#erstes Grüst, allerdings müsssen die Skalenbeschriftungen noch angepasst werden 
                                    
```

